{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>LUM</title>

    <link rel="stylesheet" href="{% static 'miniapp/css/stories.css' %}">
    <link rel="stylesheet" href="{% static 'miniapp/css/default.css' %}">
</head>
<body>

<!-- –ë–ª–æ–∫ —Å—Ç–æ—Ä–∏—Å -->
<div class="stories-wrapper">
    <div class="stories-container">
        {% for story in stories %}
            <div class="story" onclick="openStory({{ forloop.counter0 }})">
                {% if story.story_type == 'image' %}
                    <img src="{{ story.content_image.url }}" alt="{{ story.title }}">

                {% elif story.story_type == 'video' %}
                    <img src="{{ story.content_image.url }}"
                         alt="{{ story.title }}"
                         data-video="{{ story.content_video.url }}">

                {% elif story.story_type == 'text' %}
                    <div class="story-text-preview">
                        {{ story.title|truncatechars:10 }}
                    </div>
                {% endif %}
            </div>
        {% empty %}
            <p>–ò—Å—Ç–æ—Ä–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
        {% endfor %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ -->
<div id="storyModal" class="modal">
    <span class="close-btn" onclick="closeStory()">&times;</span>
    <div class="progress-container" id="progressContainer"></div>
    <div class="modal-content" id="modalContent"></div>
    <span class="nav-arrow left" onclick="prevStory()">&#10094;</span>
    <span class="nav-arrow right" onclick="nextStory()">&#10095;</span>
</div>

{% block stories %}{% endblock %}
{% block tours_list %}{% endblock %}
{% block tour_detail %}{% endblock %}
{% block drop_down %}{% endblock %}
{% block quiz %} {% endblock %}

<!-- üî• –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
<div class="bottom-nav">
    <a href="{% url 'tour-list' %}" class="nav-item">
        <div class="nav-icon">
            <!-- SVG –∏–∫–æ–Ω–∫–∞: –º–µ—Ç–∫–∞ - –ø—É–Ω–∫—Ç–∏—Ä - –º–µ—Ç–∫–∞ -->
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="5" cy="5" r="3"></circle>
                <circle cx="19" cy="19" r="3"></circle>
                <path d="M8 8 C12 12, 12 12, 16 16" stroke-dasharray="3 3"></path>
            </svg>
        </div>
        <div class="nav-label">–≠–∫—Å–∫—É—Ä—Å–∏–∏</div>
    </a>
    <a href="{% url 'profile' user.pk %}" class="nav-item">
        <div class="nav-icon">üë§</div>
        <div class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
    </a>
</div>

<script src="{% static 'miniapp/js/stories.js' %}"></script>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

</body>
</html>
